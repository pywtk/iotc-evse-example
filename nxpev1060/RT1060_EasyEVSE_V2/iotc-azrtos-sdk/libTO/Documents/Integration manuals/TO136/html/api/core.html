
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Secure Element API &#8212; libTO 6.1.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/custom.js"></script>
    <script src="../_static/custom.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="I2C wrapper API" href="i2c_wrapper.html" />
    <link rel="prev" title="Helper API" href="helper.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">release 6.1.2<br />doc</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Secure Element API</a><ul>
<li><a class="reference internal" href="#i2c-communication">I2C communication</a><ul>
<li><a class="reference internal" href="#i2c-setup">I2C setup</a></li>
<li><a class="reference internal" href="#basic-messaging">Basic messaging</a></li>
</ul>
</li>
<li><a class="reference internal" href="#secure-element-functions">Secure Element functions</a><ul>
<li><a class="reference internal" href="#nvm">NVM</a></li>
<li><a class="reference internal" href="#initialization">Initialization</a></li>
<li><a class="reference internal" href="#system">System</a></li>
<li><a class="reference internal" href="#hashes">Hashes</a></li>
<li><a class="reference internal" href="#authentication">Authentication</a></li>
<li><a class="reference internal" href="#encryption">Encryption</a></li>
<li><a class="reference internal" href="#mac">MAC</a></li>
<li><a class="reference internal" href="#secure-messaging-capi">Secure messaging CAPI</a><ul>
<li><a class="reference internal" href="#old-api">Old API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tls">TLS</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="secure-element-api">
<span id="api-to"></span><h1>Secure Element API<a class="headerlink" href="#secure-element-api" title="Permalink to this headline">¶</a></h1>
<img alt="location into library structure" class="align-right" src="../_images/lib_part_seapi.png" />
<p>This API is used to setup I2C communication and then send basic commands to
Secure Element.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TO.h&quot;</span><span class="cp"></span>
</pre></div>
</div>
<div class="section" id="i2c-communication">
<h2>I2C communication<a class="headerlink" href="#i2c-communication" title="Permalink to this headline">¶</a></h2>
<p>The following functions are used to deal with Secure Element I2C communication,
they rely on the underlying I2C wrapper (see <a class="reference internal" href="../wrapper/overview.html#i2c-wrapper"><span class="std std-ref">I2C wrapper</span></a>).</p>
<div class="section" id="i2c-setup">
<h3>I2C setup<a class="headerlink" href="#i2c-setup" title="Permalink to this headline">¶</a></h3>
<p>Functions to manage connection with Secure Element.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.TODRV_HSE_trp_config">
<span class="target" id="group__i2csetup_1gaf5aa1b0e812a6db47c76850599790a94"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TODRV_HSE_trp_config</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="n"><span class="pre">i2c_addr</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="n"><span class="pre">misc_settings</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TODRV_HSE_trp_config" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Configure hardware Secure Element transport. </p>
<p>
See TO_data_config() for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i2c_addr</strong> – I2C address to use </p></li>
<li><p><strong>misc_settings</strong> – Misc. settings byte. It has the following bit form (from MSB to LSB): RES, RES, RES, RES, RES, RES, RES, last byte NACKed. The <em>last byte NACKed</em> bit must be set to 1 if remote device NACKs last written byte.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TO_OK if configuration was successful. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="basic-messaging">
<h3>Basic messaging<a class="headerlink" href="#basic-messaging" title="Permalink to this headline">¶</a></h3>
<p>Functions to read and write data to Secure Element. They should be used only
for debug purposes, as every Secure Element API is supported by the library
(see <a class="reference internal" href="#secure-element-functions">Secure Element functions</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>I2C must be initialized, see <a class="reference internal" href="#c.TOSE_init" title="TOSE_init"><code class="xref c c-func docutils literal notranslate"><span class="pre">TOSE_init()</span></code></a>.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.TODRV_HSE_trp_write">
<span class="target" id="group__i2crw_1gae5a54ef4cad5ec806d0deff590d53cae"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TODRV_HSE_trp_write</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TODRV_HSE_trp_write" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Write data to Secure Element. </p>
<p>
This function uses the underlying TO_data_write() wrapper function. Refer to its documentation for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Buffer containing data to send </p></li>
<li><p><strong>length</strong> – Amount of data to send in bytes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TO_OK if data has been written sucessfully</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_ERROR if an internal error has occured </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TODRV_HSE_trp_read">
<span class="target" id="group__i2crw_1gac1a8da9a2805e2bebe8cbd503f827a47"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TODRV_HSE_trp_read</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TODRV_HSE_trp_read" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read data from Secure Element. </p>
<p>
This function uses the underlying TO_data_read() wrapper function. Refer to its documentation for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Buffer to store received data </p></li>
<li><p><strong>length</strong> – Amount of data to read in bytes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TO_OK if data has been read sucessfully</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_ERROR if an internal error has occured </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TODRV_HSE_trp_last_command_duration">
<span class="target" id="group__i2crw_1ga7233bc1eed647fead4ccc65f45cef132"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TODRV_HSE_trp_last_command_duration</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">duration</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TODRV_HSE_trp_last_command_duration" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Last command duration from Secure Element. </p>
<p>
This function uses the underlying TO_data_last_command_duration() wrapper function. Refer to its documentation for more details.</p>
<p>This function should only be called after a successful command or a successful TO_read() call. If it is called after a failed command or a failed TO_read(), or after a TO_write() call, the result is unspecified and may be irrelevant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> – Pointer to store last command duration in microseconds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TO_OK if data has been read sucessfully</p></li>
<li><p>TO_ERROR if an internal error has occured </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="secure-element-functions">
<span id="api-to-functions"></span><h2>Secure Element functions<a class="headerlink" href="#secure-element-functions" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To use every of these functions, I2C must be initialized, see
<a class="reference internal" href="#c.TOSE_init" title="TOSE_init"><code class="xref c c-func docutils literal notranslate"><span class="pre">TOSE_init()</span></code></a>.</p>
</div>
<p>The following API is directly based on Secure Element API.</p>
<div class="section" id="nvm">
<h3>NVM<a class="headerlink" href="#nvm" title="Permalink to this headline">¶</a></h3>
<p>Functions to use Secure Element secure data storage.</p>
<p>This zone is reserved user non-volatile memory, to store any data. No control is
performed by the secure element when manipulating this data through read and
write commands, except that the data area read/written must be within the NVM
area.</p>
<p>The Secure Element does an XOR of user key with an internal key, and uses the
resulting key to encrypt/decrypt the user data, using AES128-CBC.
The same user key must be given to write and to read back the data, or
irrelevant data will be retrieved.</p>
<p><strong>Warning</strong>:</p>
<p>NVM is a flash memory with a limited capacity in term of erase/write cycle per
sector.
Please refer to electrical characteristics for details. Please note that calling
2 writes to 2 different bytes of the same sector result in 2 erase/write cycles.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_write_nvm">
<span class="target" id="group__nvm_1ga11808ab701ba490cfa8b5b802ef9bbbb"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_write_nvm</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">offset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_AES_KEYSIZE" title="TO_AES_KEYSIZE"><span class="n"><span class="pre">TO_AES_KEYSIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_write_nvm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Write data to Secure Element NVM reserved zone. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>offset</strong> – <strong>[in]</strong> Offset in NVM reserved zone to write data </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Buffer containing data to write </p></li>
<li><p><strong>length</strong> – <strong>[in]</strong> Amount of data to write in bytes (512 bytes max.) </p></li>
<li><p><strong>key</strong> – <strong>[in]</strong> Key used to write data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TO_OK if data has been written successfully<ul class="simple">
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_ERROR if an internal error has occurred </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_read_nvm">
<span class="target" id="group__nvm_1ga14b051cbe09dfc4f98cbbfc4dfdeea54"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_read_nvm</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">offset</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_AES_KEYSIZE" title="TO_AES_KEYSIZE"><span class="n"><span class="pre">TO_AES_KEYSIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_read_nvm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read data from Secure Element NVM reserved zone. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>offset</strong> – <strong>[in]</strong> Offset in NVM reserved zone to read data </p></li>
<li><p><strong>data</strong> – <strong>[out]</strong> Buffer to store data </p></li>
<li><p><strong>length</strong> – <strong>[in]</strong> Amount of data to read in bytes (512 bytes max.) </p></li>
<li><p><strong>key</strong> – <strong>[in]</strong> Key used to read data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TO_OK if data has been read successfully<ul class="simple">
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_ERROR if an internal error has occurred </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_nvm_size">
<span class="target" id="group__nvm_1gadeb19607d62e0e2a8b3e5a71068f24a1"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_nvm_size</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_nvm_size" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get NVM reserved zone available size. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>size</strong> – <strong>[in]</strong> NVM size</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TO_OK if size has been retrieved successfully<ul class="simple">
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_ERROR if an internal error has occurred </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h3>
<p>The following functions are used to initialize the library with given driver
configuration.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.TODRV_HSE_get_ctx">
<span class="target" id="group__context__api_1ga5aaf4068e5152c624624471aca6c60d3"></span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">TODRV_HSE_get_ctx</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TODRV_HSE_get_ctx" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get HSE context. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>HSE context pointer </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TODRV_SSE_get_ctx">
<span class="target" id="group__context__api_1ga09df453da5dacc0c0394e343aa67a214"></span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">TODRV_SSE_get_ctx</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TODRV_SSE_get_ctx" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get SSE context. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>SSE context pointer </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_init">
<span class="target" id="group__setup_1gaf560aa86300dc093f79ad8bf37dba757"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initialize TO-Protect. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_fini">
<span class="target" id="group__setup_1gace267d62bf78ff0f249ea9168c970af8"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_fini</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_fini" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Uninitialize TO-Protect. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="system">
<h3>System<a class="headerlink" href="#system" title="Permalink to this headline">¶</a></h3>
<p>Misc. system functions.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_serial_number">
<span class="target" id="group__system_1ga59f0befbb5f15c3b287172183f060a6d"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_serial_number</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">serial_number</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_SN_SIZE" title="TO_SN_SIZE"><span class="n"><span class="pre">TO_SN_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_serial_number" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the unique Secure Element serial number. </p>
<p>
The Serial Number is encoded on 8 bytes :<ul class="simple">
<li><p>The first 3 bytes identify the application ID.</p></li>
<li><p>The last 5 bytes are the chip ID. Each Secure Element has an unique serial number. </p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>serial_number</strong> – <strong>[out]</strong> Secure Element serial number</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_hardware_serial_number">
<span class="target" id="group__system_1ga2d88427e0a7a8424506f9bb0da5c8418"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_hardware_serial_number</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">hardware_serial_number</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_HW_SN_SIZE" title="TO_HW_SN_SIZE"><span class="n"><span class="pre">TO_HW_SN_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_hardware_serial_number" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the hardware serial number. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>hardware_serial_number</strong> – <strong>[out]</strong> Hardware serial number </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_product_number">
<span class="target" id="group__system_1ga0d7e3fae9244a9500160dbfc5ea276c6"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_product_number</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">product_number</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_PN_SIZE" title="TO_PN_SIZE"><span class="n"><span class="pre">TO_PN_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_product_number" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the Secure Element product number. </p>
<p>
Product Number is a text string encoded on 12 bytes, e.g: “TOSF-IS1-001” </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>product_number</strong> – <strong>[out]</strong> Secure Element product number</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_hardware_version">
<span class="target" id="group__system_1gacdf7aaf4d89678c93e5d06a6a8b0f051"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_hardware_version</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">hardware_version</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_HW_VERSION_SIZE" title="TO_HW_VERSION_SIZE"><span class="n"><span class="pre">TO_HW_VERSION_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_hardware_version" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the Secure Element hardware version. </p>
<p>
Hardware version is encoded on 2 bytes. Available values are:<ul class="simple">
<li><p>00 00: Software</p></li>
<li><p>00 01: SCO136i </p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>hardware_version</strong> – <strong>[out]</strong> Secure Element hardware version</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_software_version">
<span class="target" id="group__system_1ga9ed5ce7ea97e1793e7606cb9ae62a0ac"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_software_version</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">major</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">minor</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">revision</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_software_version" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the Secure Element software version. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>major</strong> – <strong>[out]</strong> Major number. When this byte changes, API changes have occurred, incompatibility issues may be met, depending on your application. </p></li>
<li><p><strong>minor</strong> – <strong>[out]</strong> Minor number. This byte is incremented when changes happen without breaking the API. </p></li>
<li><p><strong>revision</strong> – <strong>[out]</strong> Revision number. This byte is incremented on each new build (when released). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_product_id">
<span class="target" id="group__system_1ga2dbb1a7e357ac22d8ed5b857cc2b057f"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_product_id</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">product_id</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_PRODUCT_ID_SIZE" title="TO_PRODUCT_ID_SIZE"><span class="n"><span class="pre">TO_PRODUCT_ID_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_product_id" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the Secure Element product identifier. </p>
<p>
The product identifier is a text string, encoded on maximum 15 ASCII bytes. It identifies the personalization profile. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>product_id</strong> – <strong>[out]</strong> Secure Element product identifier</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_random">
<span class="target" id="group__system_1ga4dc83413d209d1338bf437577234b174"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_random</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">random_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">random</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_random" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a random number of the given length. </p>
<p>
Request a random number to Secure Element random number generator. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>random_length</strong> – <strong>[in]</strong> Requested random length </p></li>
<li><p><strong>random</strong> – <strong>[out]</strong> Returned random number</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="hashes">
<h3>Hashes<a class="headerlink" href="#hashes" title="Permalink to this headline">¶</a></h3>
<p>Hashing functions.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_sha256">
<span class="target" id="group__hashes_1ga5c2ac64874626b71470b163015f13cc1"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_sha256</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sha256</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_sha256" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>SHA256 computation. </p>
<p>
Compute SHA256 hash on the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to compute SHA256 on </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> Data length, max. 512 bytes </p></li>
<li><p><strong>sha256</strong> – <strong>[out]</strong> returned computed SHA256</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_sha256_init">
<span class="target" id="group__hashes_1ga5461e0c53b0a2575b9d931e3be10b5c1"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_sha256_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_sha256_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Compute SHA256 on more than 512 bytes of data. </p>
<p>
This function must be followed by calls to <a class="reference internal" href="#group__hashes_1gae73dec73e69d28a3456efafdddc310a4"><span class="std std-ref">TOSE_sha256_update()</span></a> and <a class="reference internal" href="#group__hashes_1ga0d3d724e3472b4a190171474371e3afc"><span class="std std-ref">TOSE_sha256_final()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_sha256_update">
<span class="target" id="group__hashes_1gae73dec73e69d28a3456efafdddc310a4"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_sha256_update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_sha256_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Update SHA256 computation with new data. </p>
<p>
This function can be called several times to provide data to compute SHA256 on, and must be called after <a class="reference internal" href="#group__hashes_1ga5461e0c53b0a2575b9d931e3be10b5c1"><span class="std std-ref">TOSE_sha256_init()</span></a>.</p>
<p>This command is used to transmit data. It can be called several times, typically splitting the data into several blocks of 512 bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to compute SHA256 on </p></li>
<li><p><strong>length</strong> – <strong>[in]</strong> Data length, max. 512 bytes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_COND_OF_USE_NOT_SATISFIED if not called after <a class="reference internal" href="#group__hashes_1ga5461e0c53b0a2575b9d931e3be10b5c1"><span class="std std-ref">TOSE_sha256_init()</span></a> or <a class="reference internal" href="#group__hashes_1gae73dec73e69d28a3456efafdddc310a4"><span class="std std-ref">TOSE_sha256_update()</span></a></p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_sha256_final">
<span class="target" id="group__hashes_1ga0d3d724e3472b4a190171474371e3afc"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_sha256_final</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sha256</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_sha256_final" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the SHA256 hash of the data previously given. </p>
<p>
This function must be called after <a class="reference internal" href="#group__hashes_1ga5461e0c53b0a2575b9d931e3be10b5c1"><span class="std std-ref">TOSE_sha256_init()</span></a> and <a class="reference internal" href="#group__hashes_1gae73dec73e69d28a3456efafdddc310a4"><span class="std std-ref">TOSE_sha256_update()</span></a>.</p>
<p>This command finalizes the process and returns the SHA256 hash of the given data. This command handles the padding computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>sha256</strong> – <strong>[out]</strong> returned computed SHA256</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_COND_OF_USE_NOT_SATISFIED: if not called after <a class="reference internal" href="#group__hashes_1gae73dec73e69d28a3456efafdddc310a4"><span class="std std-ref">TOSE_sha256_update()</span></a></p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="authentication">
<h3>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h3>
<p>Certificates management and signature functions.</p>
<p>Secure Element certificate index is starting from 0 (if the AVNET TO136 version
supports several certificates).</p>
<p>For details on Secure Element certificate formats see Secure Element Datasheet.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_sign">
<span class="target" id="group__auth_1gaa535bfb4f13581c782c7eeca3159a96a"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_sign</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">challenge</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">challenge_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">signature</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_sign" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the Elliptic Curve Digital Signature of the given data. </p>
<p>
Note that calling this function is equivalent to calling <code class="docutils literal notranslate"><a class="reference internal" href="#group__hashes_1ga5c2ac64874626b71470b163015f13cc1"><span class="std std-ref"><span class="pre">TOSE_sha256()</span></span></a></code> followed by <code class="docutils literal notranslate"><a class="reference internal" href="#group__auth_1ga74216ef01f482387af52000268cd7646"><span class="std std-ref"><span class="pre">TOSE_sign_hash()</span></span></a></code>.</p>
<p>Signature Size is twice the size of the ECC key in bytes. With a 256 bits key, signature is 64 bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE contex </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Key index to use for signature </p></li>
<li><p><strong>challenge</strong> – <strong>[in]</strong> Challenge to be signed </p></li>
<li><p><strong>challenge_length</strong> – <strong>[in]</strong> Challenge length (maximum 512) </p></li>
<li><p><strong>signature</strong> – <strong>[out]</strong> Returned challenge signature (64 bytes)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_verify">
<span class="target" id="group__auth_1ga342c50eaff48f04e635c31e403a53b10"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_verify</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">signature</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_verify" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Verifies the given Elliptic Curve Digital Signature of the given data. </p>
<p>
The public key used for the signature verification must be previously provided using the TOSE_set_remote_public_key() call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Remote Public Key index to use for verification </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to verify signature on </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> Data length (maximum 512) </p></li>
<li><p><strong>signature</strong> – <strong>[in]</strong> Expected data signature (64 bytes)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_BAD_SIGNATURE: invalid signature</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_sign_hash">
<span class="target" id="group__auth_1ga74216ef01f482387af52000268cd7646"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_sign_hash</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">hash</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_HASH_SIZE" title="TO_HASH_SIZE"><span class="n"><span class="pre">TO_HASH_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">signature</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_sign_hash" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the Elliptic Curve Digital Signature of the given hash. </p>
<p>
Signature Size is twice the size of the ECC key in bytes. With a 256 bits key, signature is 64 bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Key index to use for signature </p></li>
<li><p><strong>hash</strong> – <strong>[in]</strong> Hash to be signed </p></li>
<li><p><strong>signature</strong> – <strong>[out]</strong> Returned hash signature</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_verify_hash_signature">
<span class="target" id="group__auth_1ga56fd12ccf9944e419b53d2fa979279b5"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_verify_hash_signature</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">hash</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_HASH_SIZE" title="TO_HASH_SIZE"><span class="n"><span class="pre">TO_HASH_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">signature</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_verify_hash_signature" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Verifies the given Elliptic Curve Digital Signature of the data that generates the given hash. </p>
<p>
The public key used for the signature verification must be previously provided using the TOSE_set_remote_public_key() call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Remote Public Key index to use for verification </p></li>
<li><p><strong>hash</strong> – <strong>[in]</strong> Hash to verify signature on (32 bytes) </p></li>
<li><p><strong>signature</strong> – <strong>[in]</strong> Expected hash signature (64 bytes)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_BAD_SIGNATURE: invalid signature</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_certificate_subject_cn">
<span class="target" id="group__auth_1ga12aa04255e8b8563880f860cb6c627f5"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_certificate_subject_cn</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">certificate_index</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="n"><span class="pre">subject_cn</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_CERT_SUBJECT_CN_MAXSIZE" title="TO_CERT_SUBJECT_CN_MAXSIZE"><span class="n"><span class="pre">TO_CERT_SUBJECT_CN_MAXSIZE</span></span></a><span class="w"> </span><span class="o"><span class="pre">+</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_certificate_subject_cn" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns subject common name of one of the Secure Element certificates. </p>
<p>
Request a certificate subject common name to Secure Element according to the given index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate_index</strong> – <strong>[in]</strong> Requested certificate index </p></li>
<li><p><strong>subject_cn</strong> – <strong>[out]</strong> Returned certificate subject common name null terminated string</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_NOT_AVAILABLE: certificate Format not supported</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid Certificate Number</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_set_certificate_signing_request_dn">
<span class="target" id="group__auth_1gaecd896158629de5ae917371454e53762"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_set_certificate_signing_request_dn</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">certificate_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">csr_dn</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_CERT_DN_MAXSIZE" title="TO_CERT_DN_MAXSIZE"><span class="n"><span class="pre">TO_CERT_DN_MAXSIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">csr_dn_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_set_certificate_signing_request_dn" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set CSR distinguished name. </p>
<p>
Set certificate distinguished name which will be used in next CSR.</p>
<p>openssl can be used to generate a fake CSR and extract the Distinguished Name sequence in DER format, like:<ul class="simple">
<li><p>openssl ecparam -out acme.key -name prime256v1 -genkey</p></li>
<li><p>openssl req -new -key acme.key -out acme.csr -subj “/CN=*.ACME.com/O=ACME/OU=Security Services”</p></li>
<li><p>openssl asn1parse -in acme.csr Note the number of the first “SEQUENCE” with depth=2; in example above, this is item number 9</p></li>
<li><p>openssl asn1parse -in acme.csr -strparse 9 -out extract_acme_DN.der and the file extract_acme_DN.der contains the Distinguished Name in DER format, that can be used as parameter to <a class="reference internal" href="#group__auth_1gaecd896158629de5ae917371454e53762"><span class="std std-ref">TOSE_set_certificate_signing_request_dn()</span></a> Double-check that Distinguished Name size (check <em>extract_acme_DN.der</em> file size on the disk) does not exceed TO_CERT_DN_MAXSIZE; else this will be rejected by libTO.</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate_index</strong> – <strong>[in]</strong> Certificate index </p></li>
<li><p><strong>csr_dn</strong> – <strong>[in]</strong> CSR distinguished name (without main sequence tag &amp; length) </p></li>
<li><p><strong>csr_dn_len</strong> – <strong>[in]</strong> CSR distinguished name length</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid Certificate Number</p></li>
<li><p>TORSP_INVALID_LEN: invalid Distinguished Name length (&gt; TO_CERT_DN_MAXSIZE)</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_certificate_signing_request">
<span class="target" id="group__auth_1ga5fe897cf4d98238cc9f72cf2e4e21bdc"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_certificate_signing_request</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">certificate_index</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">csr</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_certificate_signing_request" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get new certificate signing request. </p>
<p>
Request a x509 DER formated certificate signing request according to the given index. CSR distinguished name can be set with <a class="reference internal" href="#group__auth_1gaecd896158629de5ae917371454e53762"><span class="std std-ref">TOSE_set_certificate_signing_request_dn()</span></a>, otherwise existing certificate DN will be used (if any). Secure Element CSR size will not exceed TO_CERT_X509_MAXSIZE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate_index</strong> – <strong>[in]</strong> Certificate index to renew </p></li>
<li><p><strong>csr</strong> – <strong>[out]</strong> Returned CSR data (can be NULL to determine needed buffer size) </p></li>
<li><p><strong>size</strong> – <strong>[out]</strong> Returned CSR real size</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid Certificate Number</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_set_certificate_x509">
<span class="target" id="group__auth_1gae8b92747cda930dabc419154a7ead4c2"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_set_certificate_x509</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">certificate_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_set_certificate_x509" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set new certificate from previously generated CSR. </p>
<p>
Set a x509 DER formated certificate according to the given index. The new certificate must be signed by a CA trusted by the Secure Element. Secure Element certificate size cannot exceed TO_CERT_X509_MAXSIZE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate_index</strong> – <strong>[in]</strong> Requested certificate index </p></li>
<li><p><strong>certificate</strong> – <strong>[in]</strong> New certificate data (x509 DER formated) </p></li>
<li><p><strong>size</strong> – <strong>[in]</strong> New certificate size</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_NOT_AVAILABLE: certificate Format not supported</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid Certificate Number</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_set_certificate_x509_init">
<span class="target" id="group__auth_1ga67f3dcf260cc7d2d1766c07547d07e47"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_set_certificate_x509_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">certificate_index</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_set_certificate_x509_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initialize to set new certificate from previously generated CSR. </p>
<p>
See TOSE_set_certificate_x509</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate_index</strong> – <strong>[in]</strong> Requested certificate index</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_NOT_AVAILABLE: certificate Format not supported</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid Certificate Number</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_set_certificate_x509_update">
<span class="target" id="group__auth_1ga448076c5c03fdedeb4d6f0bee17e706c"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_set_certificate_x509_update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_set_certificate_x509_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Update to set new certificate from previously generated CSR. </p>
<p>
See TOSE_set_certificate_x509</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate</strong> – <strong>[in]</strong> New certificate partial data (from x509 DER formated) </p></li>
<li><p><strong>size</strong> – <strong>[in]</strong> New certificate partial data size</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_NOT_AVAILABLE: certificate Format not supported</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid Certificate Number</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_set_certificate_x509_final">
<span class="target" id="group__auth_1gaded48a4ba8dbba40c2d0c54adae8bdc5"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_set_certificate_x509_final</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_set_certificate_x509_final" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Finalize to set new certificate from previously generated CSR. </p>
<p>
See TOSE_set_certificate_x509</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_NOT_AVAILABLE: certificate Format not supported</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid Certificate Number</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_certificate">
<span class="target" id="group__auth_1gaf6bb5cd1e5c75e59e9e12e0a419ed10e"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_certificate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">certificate_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="defs.html#c.TO_certificate_format_t" title="TO_certificate_format_t"><span class="n"><span class="pre">TO_certificate_format_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">format</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_certificate" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns one of the Secure Element certificates. </p>
<p>
Request a certificate to Secure Element according to the given index and format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate_index</strong> – <strong>[in]</strong> Requested certificate index </p></li>
<li><p><strong>format</strong> – <strong>[in]</strong> Requested certificate format </p></li>
<li><p><strong>certificate</strong> – <strong>[out]</strong> Certificate, size depends on the certificate type (see TO_cert_*_t)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_NOT_AVAILABLE: certificate Format not supported</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid Certificate Number</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_certificate_x509">
<span class="target" id="group__auth_1ga4c1a22d353b8297d9c80b50468a79fa5"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_certificate_x509</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">certificate_index</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_certificate_x509" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns one of the certificates, x509 DER formated. </p>
<p>
Request a x509 DER formated certificate according to the given index. Secure Element certificate size will not exceed TO_CERT_X509_MAXSIZE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate_index</strong> – <strong>[in]</strong> Requested certificate index </p></li>
<li><p><strong>certificate</strong> – <strong>[out]</strong> Returned certificate data (can be NULL to determine needed buffer size) </p></li>
<li><p><strong>size</strong> – <strong>[out]</strong> Returned certificate real size</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_NOT_AVAILABLE: certificate Format not supported</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid Certificate Number</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_verify_ca_certificate_and_store">
<span class="target" id="group__auth_1ga6583a674f38fbcba8e67c2cf516b630c"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_verify_ca_certificate_and_store</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">ca_key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">subca_key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">certificate_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_verify_ca_certificate_and_store" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Requests to verify signature of the given subCA certificate; if verification succeeds, this certificate is stored into Secure Element CA slot. </p>
<p>
Note: the only supported certificate format for this command is DER X509.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>ca_key_index</strong> – <strong>[in]</strong> index of the CA slot used to verify subCA </p></li>
<li><p><strong>subca_key_index</strong> – <strong>[in]</strong> subCA index to store certificate </p></li>
<li><p><strong>certificate</strong> – <strong>[in]</strong> Certificate to be verified and stored </p></li>
<li><p><strong>certificate_len</strong> – <strong>[in]</strong> Certificate length</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid CA Key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_get_challenge_and_store">
<span class="target" id="group__auth_1gaa10bc18eda0b24b6b86ae5304db2b4c9"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_get_challenge_and_store</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">challenge</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_CHALLENGE_SIZE" title="TO_CHALLENGE_SIZE"><span class="n"><span class="pre">TO_CHALLENGE_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_get_challenge_and_store" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a challenge (random number of fixed length) and store it into Secure Element memory. </p>
<p>
This command must be called before TOSE_verify_challenge_signature().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>challenge</strong> – <strong>[out]</strong> Returned challenge</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="encryption">
<h3>Encryption<a class="headerlink" href="#encryption" title="Permalink to this headline">¶</a></h3>
<p>Ciphered messaging functions.</p>
<p>The best way to encrypt more than the maximum size of data supported by
TOSE_&lt;xxx&gt;_encrypt() command is to manually chain encryption.</p>
<p>The following steps allows to encrypt any size of data using manual blocks
chaining with the maximum security level:</p>
<a class="reference internal image-reference" href="../_images/encrypt_chaining.png"><img alt="encrypt chaining" src="../_images/encrypt_chaining.png" style="width: 80%;" /></a>
<p>The following steps allows to decrypt any size of data using manual blocks
chaining:</p>
<a class="reference internal image-reference" href="../_images/decrypt_chaining.png"><img alt="decrypt chaining" src="../_images/decrypt_chaining.png" style="width: 80%;" /></a>
<p>Here is the API list:</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_aes128cbc_encrypt">
<span class="target" id="group__encryption_1ga22cce8c18eaf1ee6020717dfc1949bb5"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_aes128cbc_encrypt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">initial_vector</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_INITIALVECTOR_SIZE" title="TO_INITIALVECTOR_SIZE"><span class="n"><span class="pre">TO_INITIALVECTOR_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_aes128cbc_encrypt" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Encrypts data using AES128 algorithm in CBC mode of operation. </p>
<p>
As padding is not handled by the Secure Element, you must ensure that data length is a multiple of 16 and is not greater than maximum length value (512 bytes). Initial vector is generated by the Secure Element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for data encryption, starting from 0 </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to encrypt </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> Length of the data to encrypt </p></li>
<li><p><strong>initial_vector</strong> – <strong>[out]</strong> Initial vector </p></li>
<li><p><strong>cryptogram</strong> – <strong>[out]</strong> Cryptogram, sent back by the Secure Element</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_INVALID_LEN: Wrong length</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_aes128cbc_iv_encrypt">
<span class="target" id="group__encryption_1gac1933d073608990f01c86cc1b8ec47d8"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_aes128cbc_iv_encrypt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">initial_vector</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_INITIALVECTOR_SIZE" title="TO_INITIALVECTOR_SIZE"><span class="n"><span class="pre">TO_INITIALVECTOR_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_aes128cbc_iv_encrypt" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Similar to encrypt() except that Initial Vector is given by user. </p>
<p><p>It can be used to encrypt more than data size limit (512 bytes) by manually chaining blocs of 512 bytes (see Secure Element Datasheet - “Encrypt or</p>
<p>decrypt more than 512 bytes” chapter for more details).</p>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using iv_encrypt() with a predictable Initial Vector can have security impact. Please let Secure Element generate Initial Vector by using encrypt() command when possible.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for data encryption, starting from 0 </p></li>
<li><p><strong>initial_vector</strong> – <strong>[in]</strong> Random data (16 bytes) </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to encrypt </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> </p></li>
<li><p><strong>cryptogram</strong> – <strong>[out]</strong> Returned encrypted data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_aes128cbc_decrypt">
<span class="target" id="group__encryption_1gaa3e473a9116a1202061c453a434fac5c"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_aes128cbc_decrypt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">initial_vector</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_INITIALVECTOR_SIZE" title="TO_INITIALVECTOR_SIZE"><span class="n"><span class="pre">TO_INITIALVECTOR_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">cryptogram_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_aes128cbc_decrypt" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Decrypts data using AES128 algorithm in CBC mode of operation. </p>
<p>
Requires the initial vector provided by the encryption function.</p>
<p>Padding is not handled by Secure Element firmware. It gives the possibility to avoid the case of a full padding block sometimes required by padding functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for data decryption, starting from 0 </p></li>
<li><p><strong>initial_vector</strong> – <strong>[in]</strong> Initial vector </p></li>
<li><p><strong>cryptogram</strong> – <strong>[in]</strong> Data to decrypt </p></li>
<li><p><strong>cryptogram_length</strong> – <strong>[in]</strong> Cryptogram length, less or equal to 512 bytes </p></li>
<li><p><strong>data</strong> – <strong>[out]</strong> returned decrypted data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_aes128gcm_encrypt">
<span class="target" id="group__encryption_1ga72def12b19bf9e10b6450b796141cfa2"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_aes128gcm_encrypt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">aad</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">aad_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">initial_vector</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_AESGCM_INITIALVECTOR_SIZE" title="TO_AESGCM_INITIALVECTOR_SIZE"><span class="n"><span class="pre">TO_AESGCM_INITIALVECTOR_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_AESGCM_TAG_SIZE" title="TO_AESGCM_TAG_SIZE"><span class="n"><span class="pre">TO_AESGCM_TAG_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_aes128gcm_encrypt" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Encrypts data using AES128 algorithm in GCM mode of operation. </p>
<p>
Additional authentication data length and data length can not exceed driver IO buffer size (if applicable). Initial vector is generated by the Secure Element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for data encryption, starting from 0 </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to encrypt </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> Length of the data to encrypt </p></li>
<li><p><strong>aad</strong> – <strong>[in]</strong> Additional authentication data </p></li>
<li><p><strong>aad_length</strong> – <strong>[in]</strong> Length of the additional authentication data </p></li>
<li><p><strong>initial_vector</strong> – <strong>[out]</strong> Initial vector </p></li>
<li><p><strong>cryptogram</strong> – <strong>[out]</strong> Cryptogram </p></li>
<li><p><strong>tag</strong> – <strong>[out]</strong> Authentication tag</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_INVALID_LEN: Wrong length</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_aes128gcm_decrypt">
<span class="target" id="group__encryption_1ga12a0878f1a1e390aa7e40f53dfe5fc4c"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_aes128gcm_decrypt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">initial_vector</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_AESGCM_INITIALVECTOR_SIZE" title="TO_AESGCM_INITIALVECTOR_SIZE"><span class="n"><span class="pre">TO_AESGCM_INITIALVECTOR_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">aad</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">aad_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">cryptogram_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_AESGCM_TAG_SIZE" title="TO_AESGCM_TAG_SIZE"><span class="n"><span class="pre">TO_AESGCM_TAG_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_aes128gcm_decrypt" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Decrypts data using AES128 algorithm in GCM mode of operation. </p>
<p>
Requires the initial vector provided by the encryption function. Additional authentication data length and cryptogram length can not exceed driver IO buffer size (if applicable).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for data decryption, starting from 0 </p></li>
<li><p><strong>initial_vector</strong> – <strong>[in]</strong> Initial vector </p></li>
<li><p><strong>aad</strong> – <strong>[in]</strong> Additional authentication data </p></li>
<li><p><strong>aad_length</strong> – <strong>[in]</strong> Length of the additional authentication data </p></li>
<li><p><strong>cryptogram</strong> – <strong>[in]</strong> Data to decrypt </p></li>
<li><p><strong>cryptogram_length</strong> – <strong>[in]</strong> Cryptogram length, less or equal to 512 bytes </p></li>
<li><p><strong>tag</strong> – <strong>[in]</strong> Authentication tag </p></li>
<li><p><strong>data</strong> – <strong>[out]</strong> returned decrypted data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_aes128ccm_encrypt">
<span class="target" id="group__encryption_1gabb43c71b05972577d09947a14d785a1a"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_aes128ccm_encrypt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">aad</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">aad_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">nonce</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_AESCCM_NONCE_SIZE" title="TO_AESCCM_NONCE_SIZE"><span class="n"><span class="pre">TO_AESCCM_NONCE_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_AESCCM_TAG_SIZE" title="TO_AESCCM_TAG_SIZE"><span class="n"><span class="pre">TO_AESCCM_TAG_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_aes128ccm_encrypt" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Encrypts data using AES128 algorithm in CCM mode of operation. </p>
<p>
Additional authentication data length and data length can not exceed driver IO buffer size (if applicable). Nonce is generated by the Secure Element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for data encryption, starting from 0 </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to encrypt </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> Length of the data to encrypt </p></li>
<li><p><strong>aad</strong> – <strong>[in]</strong> Additional authentication data </p></li>
<li><p><strong>aad_length</strong> – <strong>[in]</strong> Length of the additional authentication data </p></li>
<li><p><strong>nonce</strong> – <strong>[in]</strong> Nonce </p></li>
<li><p><strong>cryptogram</strong> – <strong>[out]</strong> Cryptogram </p></li>
<li><p><strong>tag</strong> – <strong>[out]</strong> Authentication tag</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_INVALID_LEN: Wrong length</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_aes128ccm_decrypt">
<span class="target" id="group__encryption_1ga9f16c0e6cfe4ee356f318a3469351cc4"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_aes128ccm_decrypt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">nonce</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_AESCCM_NONCE_SIZE" title="TO_AESCCM_NONCE_SIZE"><span class="n"><span class="pre">TO_AESCCM_NONCE_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">aad</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">aad_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">cryptogram_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_AESCCM_TAG_SIZE" title="TO_AESCCM_TAG_SIZE"><span class="n"><span class="pre">TO_AESCCM_TAG_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_aes128ccm_decrypt" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Decrypts data using AES128 algorithm in CCM mode of operation. </p>
<p>
Requires the nonce provided by the encryption function. Additional authentication data length and cryptogram length can not exceed driver IO buffer size (if applicable).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for data decryption, starting from 0 </p></li>
<li><p><strong>nonce</strong> – <strong>[in]</strong> Nonce </p></li>
<li><p><strong>aad</strong> – <strong>[in]</strong> Additional authentication data </p></li>
<li><p><strong>aad_length</strong> – <strong>[in]</strong> Length of the additional authentication data </p></li>
<li><p><strong>cryptogram</strong> – <strong>[in]</strong> Data to decrypt </p></li>
<li><p><strong>cryptogram_length</strong> – <strong>[in]</strong> Cryptogram length, less or equal to 512 bytes </p></li>
<li><p><strong>tag</strong> – <strong>[in]</strong> Authentication tag </p></li>
<li><p><strong>data</strong> – <strong>[out]</strong> returned decrypted data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_aes128ecb_encrypt">
<span class="target" id="group__encryption_1ga1d9bfa8f297bc076a165b5d64fada2cc"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_aes128ecb_encrypt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_aes128ecb_encrypt" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Encrypts data using AES128 algorithm in ECB mode of operation. </p>
<p>
As padding is not handled by the Secure Element, you must ensure that data length is a multiple of 16 and is not greater than maximum length value (512 bytes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for data encryption, starting from 0 </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to encrypt </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> Length of the data to encrypt </p></li>
<li><p><strong>cryptogram</strong> – <strong>[out]</strong> Cryptogram</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_INVALID_LEN: Wrong length</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_aes128ecb_decrypt">
<span class="target" id="group__encryption_1gaa69a54b02cb30d60944883d58bc356bc"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_aes128ecb_decrypt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">cryptogram_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_aes128ecb_decrypt" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Decrypts data using AES128 algorithm in ECB mode of operation. </p>
<p>
Padding is not handled by Secure Element firmware. It gives the possibility to avoid the case of a full padding block sometime required by padding functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for data decryption, starting from 0 </p></li>
<li><p><strong>cryptogram</strong> – <strong>[in]</strong> Data to decrypt </p></li>
<li><p><strong>cryptogram_length</strong> – <strong>[in]</strong> Cryptogram length, less or equal to 512 bytes </p></li>
<li><p><strong>data</strong> – <strong>[out]</strong> returned decrypted data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="mac">
<h3>MAC<a class="headerlink" href="#mac" title="Permalink to this headline">¶</a></h3>
<p>Message Authentication Code functions (HMAC and CMAC).</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_compute_hmac">
<span class="target" id="group__mac_1gadb715fa55fafccda237dad262acb4302"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_compute_hmac</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">hmac_data</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_HMAC_SIZE" title="TO_HMAC_SIZE"><span class="n"><span class="pre">TO_HMAC_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_compute_hmac" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Computes a 256-bit HMAC tag based on SHA256 hash function. </p>
<p>
If you need to compute HMAC on more than 512 bytes, please use the sequence <a class="reference internal" href="#group__mac_1gab8894e45ec85f156c7fc7649c8e42b85"><span class="std std-ref">TOSE_compute_hmac_init()</span></a>, <a class="reference internal" href="#group__mac_1ga19bc86ad58de1581f793214d86aab31b"><span class="std std-ref">TOSE_compute_hmac_update()</span></a>, …, <a class="reference internal" href="#group__mac_1ga3f4b2485d86db6e5be4d5cc0729d2702"><span class="std std-ref">TOSE_compute_hmac_final()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for HMAC calculation, starting from 0 </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to compute HMAC on </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> </p></li>
<li><p><strong>hmac_data</strong> – <strong>[out]</strong> Computed HMAC</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_compute_hmac_init">
<span class="target" id="group__mac_1gab8894e45ec85f156c7fc7649c8e42b85"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_compute_hmac_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_compute_hmac_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Compute HMAC on more than 512 bytes of data. </p>
<p>
This is the first command of the sequence <a class="reference internal" href="#group__mac_1gab8894e45ec85f156c7fc7649c8e42b85"><span class="std std-ref">TOSE_compute_hmac_init()</span></a>, <a class="reference internal" href="#group__mac_1ga19bc86ad58de1581f793214d86aab31b"><span class="std std-ref">TOSE_compute_hmac_update()</span></a>, …, <a class="reference internal" href="#group__mac_1ga3f4b2485d86db6e5be4d5cc0729d2702"><span class="std std-ref">TOSE_compute_hmac_final()</span></a>. It is used to Secure Element send Key_index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for HMAC calculation, starting from 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_compute_hmac_update">
<span class="target" id="group__mac_1ga19bc86ad58de1581f793214d86aab31b"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_compute_hmac_update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_compute_hmac_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Used to send data to compute HMAC on. </p>
<p>
This command can be called several times, new data are added to the data previously sent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to compute HMAC on </p></li>
<li><p><strong>length</strong> – <strong>[in]</strong> Data length</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_COND_OF_USE_NOT_SATISFIED: need to call <a class="reference internal" href="#group__mac_1gab8894e45ec85f156c7fc7649c8e42b85"><span class="std std-ref">TOSE_compute_hmac_init()</span></a> first</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_compute_hmac_final">
<span class="target" id="group__mac_1ga3f4b2485d86db6e5be4d5cc0729d2702"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_compute_hmac_final</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">hmac</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_HMAC_SIZE" title="TO_HMAC_SIZE"><span class="n"><span class="pre">TO_HMAC_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_compute_hmac_final" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns computed HMAC. </p>
<p>
This is the last command of the sequence <a class="reference internal" href="#group__mac_1gab8894e45ec85f156c7fc7649c8e42b85"><span class="std std-ref">TOSE_compute_hmac_init()</span></a>, <a class="reference internal" href="#group__mac_1ga19bc86ad58de1581f793214d86aab31b"><span class="std std-ref">TOSE_compute_hmac_update()</span></a>, …, <a class="reference internal" href="#group__mac_1ga3f4b2485d86db6e5be4d5cc0729d2702"><span class="std std-ref">TOSE_compute_hmac_final()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>hmac</strong> – <strong>[out]</strong> Returned computed HMAC</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_COND_OF_USE_NOT_SATISFIED: need to call <a class="reference internal" href="#group__mac_1gab8894e45ec85f156c7fc7649c8e42b85"><span class="std std-ref">TOSE_compute_hmac_init()</span></a> and <a class="reference internal" href="#group__mac_1ga19bc86ad58de1581f793214d86aab31b"><span class="std std-ref">TOSE_compute_hmac_update()</span></a> first</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_verify_hmac">
<span class="target" id="group__mac_1gac2ad8f8f4b1c7d0481f079ab26fbd756"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_verify_hmac</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">hmac_data</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_HMAC_SIZE" title="TO_HMAC_SIZE"><span class="n"><span class="pre">TO_HMAC_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_verify_hmac" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Verifies if the HMAC tag is correct for the given data. </p>
<p>
If you need to verify HMAC of more than 512 bytes, please use the combination of <a class="reference internal" href="#group__mac_1ga3c301ec537c7d42c2abe8a42d42e9bbc"><span class="std std-ref">TOSE_verify_hmac_init()</span></a>, <a class="reference internal" href="#group__mac_1gacb399ee77ec8eb475495fe0c4fbe7ce0"><span class="std std-ref">TOSE_verify_hmac_update()</span></a>, …, <a class="reference internal" href="#group__mac_1ga66238d80fdcd64ac834f6fb7a182b2e2"><span class="std std-ref">TOSE_verify_hmac_final()</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for HMAC calculation, starting from 0 </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to verify HMAC on </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> </p></li>
<li><p><strong>hmac_data</strong> – <strong>[in]</strong> expected HMAC value</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_BAD_SIGNATURE: verification failed</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_verify_hmac_init">
<span class="target" id="group__mac_1ga3c301ec537c7d42c2abe8a42d42e9bbc"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_verify_hmac_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_verify_hmac_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Verify HMAC on more than 512 bytes of data. </p>
<p>
When you need to verify HMAC of more than 512 bytes you need to call this function first with the key index - as sent to verify_hmac(). Data will be sent with verify_hmac_update() and HMAC will be sent with verify_hmac_final().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for HMAC calculation, starting from 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_verify_hmac_update">
<span class="target" id="group__mac_1gacb399ee77ec8eb475495fe0c4fbe7ce0"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_verify_hmac_update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_verify_hmac_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Used to send data to verify HMAC on. </p>
<p>
After calling <a class="reference internal" href="#group__mac_1ga3c301ec537c7d42c2abe8a42d42e9bbc"><span class="std std-ref">TOSE_verify_hmac_init()</span></a> to provide key index, you can call <a class="reference internal" href="#group__mac_1gacb399ee77ec8eb475495fe0c4fbe7ce0"><span class="std std-ref">TOSE_verify_hmac_update()</span></a> to send the data to verify HMAC on. This command can be called several times, and new data are added to the previous one for HMAC verification. Last command to use is <a class="reference internal" href="#group__mac_1ga66238d80fdcd64ac834f6fb7a182b2e2"><span class="std std-ref">TOSE_verify_hmac_final()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to verify HMAC on </p></li>
<li><p><strong>length</strong> – <strong>[in]</strong> Data length</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_COND_OF_USE_NOT_SATISFIED: need to call VERIFY_HMAC_INIT first</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_verify_hmac_final">
<span class="target" id="group__mac_1ga66238d80fdcd64ac834f6fb7a182b2e2"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_verify_hmac_final</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">hmac</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_HMAC_SIZE" title="TO_HMAC_SIZE"><span class="n"><span class="pre">TO_HMAC_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_verify_hmac_final" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This command is used to send HMAC to verify. </p>
<p>
Data was previously sent by the sequence <a class="reference internal" href="#group__mac_1ga3c301ec537c7d42c2abe8a42d42e9bbc"><span class="std std-ref">TOSE_verify_hmac_init()</span></a>, <a class="reference internal" href="#group__mac_1gacb399ee77ec8eb475495fe0c4fbe7ce0"><span class="std std-ref">TOSE_verify_hmac_update()</span></a>, …, <a class="reference internal" href="#group__mac_1ga66238d80fdcd64ac834f6fb7a182b2e2"><span class="std std-ref">TOSE_verify_hmac_final()</span></a>. This command succeeds if the HMAC is correct for the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>hmac</strong> – <strong>[in]</strong> HMAC to verify</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_BAD_SIGNATURE: verification failed</p></li>
<li><p>TORSP_COND_OF_USE_NOT_SATISFIED: <a class="reference internal" href="#group__mac_1ga3c301ec537c7d42c2abe8a42d42e9bbc"><span class="std std-ref">TOSE_verify_hmac_init()</span></a> or <a class="reference internal" href="#group__mac_1gacb399ee77ec8eb475495fe0c4fbe7ce0"><span class="std std-ref">TOSE_verify_hmac_update()</span></a> were not called before this command</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_compute_cmac">
<span class="target" id="group__mac_1gad49f5ec7ff9f69789d9a18f3d3294a4a"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_compute_cmac</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">cmac_data</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_CMAC_SIZE" title="TO_CMAC_SIZE"><span class="n"><span class="pre">TO_CMAC_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_compute_cmac" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Compute CMAC. </p>
<p>
Compute a 128-bit CMAC tag based on AES128 algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use for CMAC calculation, starting from 0 </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to compute CMAC on </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> </p></li>
<li><p><strong>cmac_data</strong> – <strong>[out]</strong> Returned computed CMAC</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_verify_cmac">
<span class="target" id="group__mac_1ga64b8b11a876bd0a95a323019e10dc7b5"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_verify_cmac</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">cmac_data</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_CMAC_SIZE" title="TO_CMAC_SIZE"><span class="n"><span class="pre">TO_CMAC_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_verify_cmac" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Verify CMAC. </p>
<p>
Verify if the CMAC tag is correct for the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the key to use to compute the CMAC tag, starting from 0 </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Data to verify CMAC on </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> </p></li>
<li><p><strong>cmac_data</strong> – <strong>[in]</strong> expected CMAC</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_BAD_SIGNATURE: verification failed</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="secure-messaging-capi">
<span id="api-secmsg-capi"></span><h3>Secure messaging CAPI<a class="headerlink" href="#secure-messaging-capi" title="Permalink to this headline">¶</a></h3>
<p>Secure messaging functions.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_secure_payload_init">
<span class="target" id="group__secmsg__capi_1ga5d7280111873e45c08cc9f045c478307"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_secure_payload_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="defs.html#c.TO_enc_alg_t" title="TO_enc_alg_t"><span class="n"><span class="pre">TO_enc_alg_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">enc_alg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="defs.html#c.TO_mac_alg_t" title="TO_mac_alg_t"><span class="n"><span class="pre">TO_mac_alg_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">mac_alg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_len</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_SEQUENCE_SIZE" title="TO_SEQUENCE_SIZE"><span class="n"><span class="pre">TO_SEQUENCE_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">iv</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">iv_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_secure_payload_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initializes transform of a message into a secured payload. </p>
<p>
Initial vector is generated by the Secure Element and not included in the data length</p>
<p>Initial vector length is also given by <a class="reference internal" href="defs.html#group__payloads_1ga6e57363655b82cf8667b9ee7b8af5ed3"><span class="std std-ref">TO_PAYLOAD_IV_SIZE()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the keys to use for data encryption and MAC, starting from 0 </p></li>
<li><p><strong>enc_alg</strong> – <strong>[in]</strong> Encryption algorithm to use </p></li>
<li><p><strong>mac_alg</strong> – <strong>[in]</strong> MAC algorithm to use </p></li>
<li><p><strong>data_len</strong> – <strong>[in]</strong> Full data length </p></li>
<li><p><strong>sequence</strong> – <strong>[in]</strong> Sequence counter to avoid replay attacks </p></li>
<li><p><strong>iv</strong> – <strong>[out]</strong> Initial vector </p></li>
<li><p><strong>iv_len</strong> – <strong>[out]</strong> Initial vector length</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_NOT_AVAILABLE: algorithm not available</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_secure_payload_update">
<span class="target" id="group__secmsg__capi_1gaaca0a127dacb791fd127d5c01211f8f3"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_secure_payload_update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_len</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_secure_payload_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Updates transform of a message into a secured payload. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Message part to be secured </p></li>
<li><p><strong>data_len</strong> – <strong>[in]</strong> Message part length (must be multiple of 16) </p></li>
<li><p><strong>cryptogram</strong> – <strong>[out]</strong> Message cryptogram (same length)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_NOT_AVAILABLE: algorithm not available</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_secure_payload_final">
<span class="target" id="group__secmsg__capi_1ga3e5068f141510e51d03d301e8aa59e8d"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_secure_payload_final</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_len</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_secure_payload_final" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Finaliazes transform of a message into a secured payload. </p>
<p>
The MAC tag is calculated on clear data, including sequence counter. This function will add padding after MAC if clear data size is not aligned. Padding scheme is PKCS7 with extra padding length byte (TLS like).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Final message part to be secured </p></li>
<li><p><strong>data_len</strong> – <strong>[in]</strong> Final message part length (0 &lt;= data_len &lt; 16) </p></li>
<li><p><strong>cryptogram</strong> – <strong>[out]</strong> Final message cryptogram (containing MAC and padding) </p></li>
<li><p><strong>cryptogram_len</strong> – <strong>[out]</strong> Final message cryptogram length</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_NOT_AVAILABLE: algorithm not available</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_unsecure_payload_init_cbc">
<span class="target" id="group__secmsg__capi_1ga3cabcc530d4e337ee5357178e8af3a41"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_unsecure_payload_init_cbc</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="defs.html#c.TO_enc_alg_t" title="TO_enc_alg_t"><span class="n"><span class="pre">TO_enc_alg_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">enc_alg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="defs.html#c.TO_mac_alg_t" title="TO_mac_alg_t"><span class="n"><span class="pre">TO_mac_alg_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">mac_alg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">cryptogram_len</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_SEQUENCE_SIZE" title="TO_SEQUENCE_SIZE"><span class="n"><span class="pre">TO_SEQUENCE_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">initial_vector</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_INITIALVECTOR_SIZE" title="TO_INITIALVECTOR_SIZE"><span class="n"><span class="pre">TO_INITIALVECTOR_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">last_block_iv</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_INITIALVECTOR_SIZE" title="TO_INITIALVECTOR_SIZE"><span class="n"><span class="pre">TO_INITIALVECTOR_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">last_block</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_AES_BLOCK_SIZE" title="TO_AES_BLOCK_SIZE"><span class="n"><span class="pre">TO_AES_BLOCK_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_unsecure_payload_init_cbc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initializes to get back a message from a secured payload (CBC). </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the keys to use for data encryption and MAC, starting from 0 </p></li>
<li><p><strong>enc_alg</strong> – <strong>[in]</strong> Encryption algorithm to use </p></li>
<li><p><strong>mac_alg</strong> – <strong>[in]</strong> MAC algorithm to use </p></li>
<li><p><strong>cryptogram_len</strong> – <strong>[in]</strong> Cryptogram length </p></li>
<li><p><strong>sequence</strong> – <strong>[in]</strong> Sequence counter to avoid replay attacks </p></li>
<li><p><strong>initial_vector</strong> – <strong>[in]</strong> Block of 16 random bytes generated by the Secure Element and required to decrypt the data </p></li>
<li><p><strong>last_block_iv</strong> – <strong>[in]</strong> Last AES block initial vector (penultimate block) </p></li>
<li><p><strong>last_block</strong> – <strong>[in]</strong> Last AES block</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_NOT_AVAILABLE: algorithm not available</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_unsecure_payload_init_aead">
<span class="target" id="group__secmsg__capi_1ga1a999e569e8584851a6ff1dba84308b6"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_unsecure_payload_init_aead</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">key_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="defs.html#c.TO_enc_alg_t" title="TO_enc_alg_t"><span class="n"><span class="pre">TO_enc_alg_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">enc_alg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="defs.html#c.TO_mac_alg_t" title="TO_mac_alg_t"><span class="n"><span class="pre">TO_mac_alg_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">mac_alg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">cryptogram_len</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_SEQUENCE_SIZE" title="TO_SEQUENCE_SIZE"><span class="n"><span class="pre">TO_SEQUENCE_SIZE</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_unsecure_payload_init_aead" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initializes to get back a message from a secured payload (AEAD). </p>
<p>
Do not use this function directly, use <a class="reference internal" href="helper.html#group__helper__secmsg_1ga3c946ab1093d20b3c570b7946220a319"><span class="std std-ref">TOSE_helper_unsecure_payload()</span></a> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>key_index</strong> – <strong>[in]</strong> Index of the keys to use for data encryption and MAC, starting from 0 </p></li>
<li><p><strong>enc_alg</strong> – <strong>[in]</strong> Encryption algorithm to use </p></li>
<li><p><strong>mac_alg</strong> – <strong>[in]</strong> MAC algorithm to use </p></li>
<li><p><strong>cryptogram_len</strong> – <strong>[in]</strong> Cryptogram length </p></li>
<li><p><strong>sequence</strong> – <strong>[in]</strong> Sequence counter to avoid replay attacks</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_NOT_AVAILABLE: algorithm not available</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_unsecure_payload_update">
<span class="target" id="group__secmsg__capi_1gaa1b03cde8efe7bd013f89acdeaad261e"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_unsecure_payload_update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cryptogram</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">cryptogram_len</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_unsecure_payload_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Updates to get back a message from a secured payload. </p>
<p>
Do not use this function directly, use <a class="reference internal" href="helper.html#group__helper__secmsg_1ga3c946ab1093d20b3c570b7946220a319"><span class="std std-ref">TOSE_helper_unsecure_payload()</span></a> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>cryptogram</strong> – <strong>[in]</strong> Message cryptogram </p></li>
<li><p><strong>cryptogram_len</strong> – <strong>[in]</strong> Message cryptogram length </p></li>
<li><p><strong>data</strong> – <strong>[out]</strong> Message unsecured </p></li>
<li><p><strong>data_len</strong> – <strong>[out]</strong> Message length</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_NOT_AVAILABLE: algorithm not available</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_unsecure_payload_final">
<span class="target" id="group__secmsg__capi_1ga680af3c4ddfb37ab9804f420ec278e41"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_unsecure_payload_final</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_unsecure_payload_final" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Finalizes to get back a message from a secured payload. </p>
<p>
Do not use this function directly, use <a class="reference internal" href="helper.html#group__helper__secmsg_1ga3c946ab1093d20b3c570b7946220a319"><span class="std std-ref">TOSE_helper_unsecure_payload()</span></a> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TORSP_NOT_AVAILABLE: algorithm not available</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<div class="section" id="old-api">
<span id="api-secmsg-old"></span><h4>Old API<a class="headerlink" href="#old-api" title="Permalink to this headline">¶</a></h4>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 4.10.0: </span>Use new <a href="#id1"><span class="problematic" id="id2">`Secure messaging`_</span></a>.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c">
<span class="target" id="group__secmsg__old__api_1ga23c5748f5bf1a57a4b6ab56db516607d"></span><span class="sig-name descname"><span class="pre">TO_ret_t</span> <span class="pre">TOSE_aes128cbc_hmac_secure_message</span> <span class="pre">(TOSE_ctx_t</span> <span class="pre">*ctx,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">aes_key_index,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">hmac_key_index,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">*data,</span> <span class="pre">const</span> <span class="pre">uint16_t</span> <span class="pre">data_length,</span> <span class="pre">uint8_t</span> <span class="pre">initial_vector[TO_INITIALVECTOR_SIZE],</span> <span class="pre">uint8_t</span> <span class="pre">*cryptogram,</span> <span class="pre">uint8_t</span> <span class="pre">hmac[TO_HMAC_SIZE])</span> <span class="pre">TO_DEPRECATED</span></span></dt>
<dd><p>Transforms a message into a secured message (AES128-CBC cryptogram and HMAC tag). </p>
<p>
It is equivalent to call <a class="reference internal" href="#group__encryption_1ga22cce8c18eaf1ee6020717dfc1949bb5"><span class="std std-ref">TOSE_aes128cbc_encrypt()</span></a> command, then <a class="reference internal" href="#group__mac_1gadb715fa55fafccda237dad262acb4302"><span class="std std-ref">TOSE_compute_hmac()</span></a> on the result. The HMAC tag is calculated on encrypted data. Typical use is to have the same value to both AES and HMAC Key indexes. If remote public key is known and trusted by the Secure Element, the Secure Element’s public key could be added to the result of this command and could be used on to have one way only communication network (from Secure Element to remote only).</p>
<p>Note: As padding is not handled by the the Secure Element, you must ensure that data length is a multiple of 16 and is not greater than maximum length value (512 bytes). Initial vector is generated by the Secure Element and not included in the data length</p>
<p>This API is deprecated, use TOSE_secure_payload() instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>aes_key_index</strong> – <strong>[in]</strong> Index of the key to use for data encryption, starting from 0 </p></li>
<li><p><strong>hmac_key_index</strong> – <strong>[in]</strong> Index of the key to use for HMAC, starting from 0 </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Message to be secured </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> </p></li>
<li><p><strong>initial_vector</strong> – <strong>[out]</strong> Block of 16 random bytes generated by the Secure Element and required to decrypt the data </p></li>
<li><p><strong>cryptogram</strong> – <strong>[out]</strong> Message cryptogram (same size as data) </p></li>
<li><p><strong>hmac</strong> – <strong>[out]</strong> Message HMAC</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c">
<span class="target" id="group__secmsg__old__api_1ga6fd033a74a83b30a4517637e1688d4ec"></span><span class="sig-name descname"><span class="pre">TO_ret_t</span> <span class="pre">TOSE_aes128cbc_hmac_unsecure_message</span> <span class="pre">(TOSE_ctx_t</span> <span class="pre">*ctx,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">aes_key_index,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">hmac_key_index,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">initial_vector[TO_INITIALVECTOR_SIZE],</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">*cryptogram,</span> <span class="pre">const</span> <span class="pre">uint16_t</span> <span class="pre">cryptogram_length,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">hmac[TO_HMAC_SIZE],</span> <span class="pre">uint8_t</span> <span class="pre">*data)</span> <span class="pre">TO_DEPRECATED</span></span></dt>
<dd><p>Get back a message from a secured message (AES128-CBC cryptogram and HMAC tag). </p>
<p>
Data are decrypted only if the HMAC tag is valid.</p>
<p>This API is deprecated, use TOSE_unsecure_payload() instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>aes_key_index</strong> – <strong>[in]</strong> Index of the key to use for data decryption, starting from 0 </p></li>
<li><p><strong>hmac_key_index</strong> – <strong>[in]</strong> Index of the key to use for HMAC verification, starting from 0 </p></li>
<li><p><strong>initial_vector</strong> – <strong>[in]</strong> Initial vector for decryption </p></li>
<li><p><strong>cryptogram</strong> – <strong>[in]</strong> Message cryptogram </p></li>
<li><p><strong>cryptogram_length</strong> – <strong>[in]</strong> </p></li>
<li><p><strong>hmac</strong> – <strong>[in]</strong> Expected HMAC </p></li>
<li><p><strong>data</strong> – <strong>[out]</strong> Decrypted data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c">
<span class="target" id="group__secmsg__old__api_1gaef9666d8de58af6d084a15fa75a7771e"></span><span class="sig-name descname"><span class="pre">TO_ret_t</span> <span class="pre">TOSE_aes128cbc_cmac_secure_message</span> <span class="pre">(TOSE_ctx_t</span> <span class="pre">*ctx,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">aes_key_index,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">cmac_key_index,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">*data,</span> <span class="pre">const</span> <span class="pre">uint16_t</span> <span class="pre">data_length,</span> <span class="pre">uint8_t</span> <span class="pre">initial_vector[TO_INITIALVECTOR_SIZE],</span> <span class="pre">uint8_t</span> <span class="pre">*cryptogram,</span> <span class="pre">uint8_t</span> <span class="pre">cmac[TO_CMAC_SIZE])</span> <span class="pre">TO_DEPRECATED</span></span></dt>
<dd><p>Transforms a message into a secured message (AES128-CBC cryptogram and CMAC tag). </p>
<p>
It is equivalent to call <a class="reference internal" href="#group__encryption_1ga22cce8c18eaf1ee6020717dfc1949bb5"><span class="std std-ref">TOSE_aes128cbc_encrypt()</span></a> command, then <a class="reference internal" href="#group__mac_1gad49f5ec7ff9f69789d9a18f3d3294a4a"><span class="std std-ref">TOSE_compute_cmac()</span></a> on the result. The CMAC tag is calculated on encrypted data. Typical use is to have the same value to both AES and CMAC Key indexes. If remote public key is known and trusted by the Secure Element, the Secure Element’s public key could be added to the result of this command and could be used on to have one way only communication network (from Secure Element to remote only).</p>
<p>Note: As padding is not handled by the Secure Element, you must ensure that data length is a multiple of 16 and is not greater than maximum length value (512 bytes). Initial vector is generated by the Secure Element and not included in the data length</p>
<p>This API is deprecated, use TOSE_secure_payload() instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>aes_key_index</strong> – <strong>[in]</strong> Index of the key to use for data encryption, starting from 0 </p></li>
<li><p><strong>cmac_key_index</strong> – <strong>[in]</strong> Index of the key to use for CMAC, starting from 0 </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Message to be secured </p></li>
<li><p><strong>data_length</strong> – <strong>[in]</strong> </p></li>
<li><p><strong>initial_vector</strong> – <strong>[out]</strong> Block of 16 random bytes generated by the Secure Element and required to decrypt the data </p></li>
<li><p><strong>cryptogram</strong> – <strong>[out]</strong> Message cryptogram (same size as data) </p></li>
<li><p><strong>cmac</strong> – <strong>[out]</strong> Message CMAC</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c">
<span class="target" id="group__secmsg__old__api_1ga2eaa38e669e00862706309efcf9ead76"></span><span class="sig-name descname"><span class="pre">TO_ret_t</span> <span class="pre">TOSE_aes128cbc_cmac_unsecure_message</span> <span class="pre">(TOSE_ctx_t</span> <span class="pre">*ctx,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">aes_key_index,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">cmac_key_index,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">initial_vector[TO_INITIALVECTOR_SIZE],</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">*cryptogram,</span> <span class="pre">const</span> <span class="pre">uint16_t</span> <span class="pre">cryptogram_length,</span> <span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">cmac[TO_CMAC_SIZE],</span> <span class="pre">uint8_t</span> <span class="pre">*data)</span> <span class="pre">TO_DEPRECATED</span></span></dt>
<dd><p>Get back a message from a secured message (AES128-CBC cryptogram and CMAC tag). </p>
<p>
Data are decrypted only if the CMAC tag is valid.</p>
<p>This API is deprecated, use TOSE_unsecure_payload() instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>aes_key_index</strong> – <strong>[in]</strong> Index of the key to use for data decryption, starting from 0 </p></li>
<li><p><strong>cmac_key_index</strong> – <strong>[in]</strong> Index of the key to use for CMAC verification, starting from 0 </p></li>
<li><p><strong>initial_vector</strong> – <strong>[in]</strong> Initial vector for decryption </p></li>
<li><p><strong>cryptogram</strong> – <strong>[in]</strong> Message cryptogram </p></li>
<li><p><strong>cryptogram_length</strong> – <strong>[in]</strong> </p></li>
<li><p><strong>cmac</strong> – <strong>[in]</strong> Expected CMAC </p></li>
<li><p><strong>data</strong> – <strong>[out]</strong> Decrypted data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>TORSP_SUCCESS on success</p></li>
<li><p>TORSP_ARG_OUT_OF_RANGE: invalid key index</p></li>
<li><p>TO_DEVICE_WRITE_ERROR: error writing data to Secure Element</p></li>
<li><p>TO_DEVICE_READ_ERROR: error reading data from Secure Element</p></li>
<li><p>TO_INVALID_RESPONSE_LENGTH: unexpected response length from device</p></li>
<li><p>TO_MEMORY_ERROR: internal I/O buffer overflow</p></li>
<li><p>TO_ERROR: generic error </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="tls">
<h3>TLS<a class="headerlink" href="#tls" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_reset">
<span class="target" id="group__tlsoptim_1gad852566ace9f4c8aeafa32f612a5058a"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_reset</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_reset" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Resets the current TLS/DTLS session. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><p>After resetting the session, a full handshake will have to be re-negociated, as the session keys and master secrets are reset for this session. It does not have any influence on the other sessions that may be opened.</p>
<p>It can be used also to fix a malfunctioning TLS slot.</p>
</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c">
<span class="target" id="group__tlsoptim_1gac3908fb429c1cfb7b5e54138272bf1f9"></span><span class="sig-name descname"><span class="pre">TO_ret_t</span> <span class="pre">TOSE_tls_set_mode</span> <span class="pre">(TOSE_ctx_t</span> <span class="pre">*ctx,</span> <span class="pre">const</span> <span class="pre">TO_tls_mode_t</span> <span class="pre">mode)</span> <span class="pre">TO_DEPRECATED</span></span></dt>
<dd><p>Selects between TLS and DTLS mode and resets the session for the current selected slot. </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Deprecated:</span></em></dt>
<dd></dd></dl>

</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>mode</strong> – <strong>[in]</strong> TLS mode. Currently only <a class="reference internal" href="defs.html#group__tls__constants_1ggaba7204d9e3bf554431db84cb24e636d8adc046f232b6b1161aff3e83e59f43501"><span class="std std-ref">TO_TLS_MODE_TLS_1_2</span></a> and <a class="reference internal" href="defs.html#group__tls__constants_1ggaba7204d9e3bf554431db84cb24e636d8adbd770bffc4f90b830d516c35a23e95e"><span class="std std-ref">TO_TLS_MODE_DTLS_1_2</span></a> are supported. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_set_config">
<span class="target" id="group__tlsoptim_1gaf263f03569e36f2e93bd6296c809c4c5"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_set_config</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="defs.html#c.TO_tls_config_id_t" title="TO_tls_config_id_t"><span class="n"><span class="pre">TO_tls_config_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">config_id</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">config</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">config_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_set_config" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set TLS config (either mode or cipher suite selection). </p>
<p>
Permits to switch to TLS or DTLS, to select a cipher suite for the handshake and resets the current session (if the configuration has changed). </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>config_id</strong> – <strong>[in]</strong> TLS configuration ID (either <a class="reference internal" href="defs.html#group__tls__constants_1ggaab1f1a448e9d71ebb0139704e2e93ebfae7a0bfdfaf72718ac1526acddf376dbf"><span class="std std-ref">TO_TLS_CONFIG_ID_MODE</span></a> or <a class="reference internal" href="defs.html#group__tls__constants_1ggaab1f1a448e9d71ebb0139704e2e93ebfa1c5970796fb78aa920e0c3f2243ad316"><span class="std std-ref">TO_TLS_CONFIG_ID_CIPHER_SUITES</span></a>) </p></li>
<li><p><strong>config</strong> – <strong>[in]</strong> Pointer to the desired new TLS configuration </p></li>
<li><p><strong>config_len</strong> – <strong>[in]</strong> TLS configuration length (1 for the mode, 2 for the cipher suite)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_set_session">
<span class="target" id="group__tlsoptim_1ga3e3ac4dc3e141007d106bc30fb433c53"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_set_session</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">session</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_set_session" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Selects the current TLS session slot to be used. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are several session slots available which can be connected to different servers. Depending on your application you may have to switch between those session slots. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>session</strong> – <strong>[in]</strong> TLS session ID </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_set_cid_ext_id">
<span class="target" id="group__tlsoptim_1ga12d01fea2b581a16cf0275122d3e81fc"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_set_cid_ext_id</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="defs.html#c.TO_tls_extension_t" title="TO_tls_extension_t"><span class="n"><span class="pre">TO_tls_extension_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">cid_ext_id</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_set_cid_ext_id" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set sets the type of the extension ID corresponding to the connection ID. </p>
<p>
Currently, the ID corresponding to the connection ID is still part of a draft standard (dec. 2021). Until the moment the RFC standard is published, this entry-point is used to provide this information. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>cid_ext_id</strong> – <strong>[in]</strong> Connection ID extension ID</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_client_hello">
<span class="target" id="group__tlsoptim_1ga8b33242b3f87f33878bb55b387f3ffcb"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_client_hello</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">timestamp</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_TIMESTAMP_SIZE" title="TO_TIMESTAMP_SIZE"><span class="n"><span class="pre">TO_TIMESTAMP_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">client_hello</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">client_hello_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_client_hello" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Generates the TLS Client_Hello (client) message. </p>
<p>
When a client first connects to a server, it is required to send the ClientHello as its first message. The client can also send a ClientHello in response to a HelloRequest or on its own initiative in order to renegotiate the security parameters in an existing connection. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>timestamp</strong> – <strong>[in]</strong> Timestamp (seconds since epoch) </p></li>
<li><p><strong>client_hello</strong> – <strong>[out]</strong> Pointer to a buffer receiving the ClientHello payload (up to 79 bytes in TLS, 120 bytes in DTLS) </p></li>
<li><p><strong>client_hello_len</strong> – <strong>[out]</strong> Pointer to receive the ClientHello payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_client_hello_ext">
<span class="target" id="group__tlsoptim_1ga677d3086d4f37822e1b995e7a4e8c028"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_client_hello_ext</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">timestamp</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_TIMESTAMP_SIZE" title="TO_TIMESTAMP_SIZE"><span class="n"><span class="pre">TO_TIMESTAMP_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ext_data</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">ext_length</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">client_hello</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">client_hello_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_client_hello_ext" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get TLS ClientHello with extension. </p>
<p>
Return the TLS handshake payload of the standard TLS “ClientHello” message. This payload must be encapsulated in a TLS record. The length of the response can be different depending on the use case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> SE context </p></li>
<li><p><strong>timestamp</strong> – <strong>[in]</strong> Timestamp (seconds since epoch) </p></li>
<li><p><strong>ext_data</strong> – <strong>[in]</strong> extension data </p></li>
<li><p><strong>ext_length</strong> – <strong>[in]</strong> extension length </p></li>
<li><p><strong>client_hello</strong> – <strong>[out]</strong> ClientHello payload </p></li>
<li><p><strong>client_hello_len</strong> – <strong>[out]</strong> ClientHello payload length</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TORSP_SUCCESS</strong> – on success </p></li>
<li><p><strong>TO_DEVICE_WRITE_ERROR</strong> – error writing data to Secure Element </p></li>
<li><p><strong>TO_DEVICE_READ_ERROR</strong> – error reading data from Secure Element </p></li>
<li><p><strong>TO_INVALID_RESPONSE_LENGTH</strong> – unexpected response length from device </p></li>
<li><p><strong>TO_MEMORY_ERROR</strong> – internal I/O buffer overflow </p></li>
<li><p><strong>TO_ERROR</strong> – generic error </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_client_hello_init">
<span class="target" id="group__tlsoptim_1gaa7a09d3a0c98901f751d897c7f0208b8"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_client_hello_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">timestamp</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="defs.html#c.TO_TIMESTAMP_SIZE" title="TO_TIMESTAMP_SIZE"><span class="n"><span class="pre">TO_TIMESTAMP_SIZE</span></span></a><span class="p"><span class="pre">]</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ext_data</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">ext_length</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">client_hello_len</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">final_flag</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_client_hello_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get TLS ClientHello - CAPI version - Init. </p>
<p>
Initialize retrieval of the TLS handshake payload of the standard TLS “ClientHello” message. This payload must be encapsulated in a TLS record.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> SE context </p></li>
<li><p><strong>timestamp</strong> – <strong>[in]</strong> Timestamp (seconds since epoch) </p></li>
<li><p><strong>ext_data</strong> – <strong>[in]</strong> extension data </p></li>
<li><p><strong>ext_length</strong> – <strong>[in]</strong> extension length </p></li>
<li><p><strong>client_hello_len</strong> – <strong>[out]</strong> ClientHello payload length </p></li>
<li><p><strong>final_flag</strong> – <strong>[out]</strong> signal the final chunk of ClientHello to be received with <a class="reference internal" href="#group__tlsoptim_1ga9426588ee6d66c36e5eb56442ca16d88"><span class="std std-ref">TOSE_tls_get_client_hello_final()</span></a></p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TORSP_SUCCESS</strong> – on success </p></li>
<li><p><strong>TO_DEVICE_WRITE_ERROR</strong> – error writing data to Secure Element </p></li>
<li><p><strong>TO_DEVICE_READ_ERROR</strong> – error reading data from Secure Element </p></li>
<li><p><strong>TO_INVALID_RESPONSE_LENGTH</strong> – unexpected response length from device </p></li>
<li><p><strong>TO_MEMORY_ERROR</strong> – internal I/O buffer overflow </p></li>
<li><p><strong>TO_ERROR</strong> – generic error </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_client_hello_update">
<span class="target" id="group__tlsoptim_1ga2246725fea872d2b38eb772147f65a66"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_client_hello_update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">part_len</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">final_flag</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_client_hello_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get TLS ClientHello - CAPI version - Update. </p>
<p>
Return a part of the TLS handshake payload of the standard TLS “ClientHello” message. This payload must be encapsulated in a TLS record.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> SE context </p></li>
<li><p><strong>data</strong> – <strong>[out]</strong> ClientHello payload part </p></li>
<li><p><strong>part_len</strong> – <strong>[out]</strong> ClientHello payload part length </p></li>
<li><p><strong>final_flag</strong> – <strong>[out]</strong> signal the final chunk of ClientHello to be received with <a class="reference internal" href="#group__tlsoptim_1ga9426588ee6d66c36e5eb56442ca16d88"><span class="std std-ref">TOSE_tls_get_client_hello_final()</span></a></p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TORSP_SUCCESS</strong> – on success </p></li>
<li><p><strong>TO_DEVICE_WRITE_ERROR</strong> – error writing data to Secure Element </p></li>
<li><p><strong>TO_DEVICE_READ_ERROR</strong> – error reading data from Secure Element </p></li>
<li><p><strong>TO_INVALID_RESPONSE_LENGTH</strong> – unexpected response length from device </p></li>
<li><p><strong>TO_MEMORY_ERROR</strong> – internal I/O buffer overflow </p></li>
<li><p><strong>TO_ERROR</strong> – generic error </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_client_hello_final">
<span class="target" id="group__tlsoptim_1ga9426588ee6d66c36e5eb56442ca16d88"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_client_hello_final</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_client_hello_final" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get TLS ClientHello - CAPI version - Final. </p>
<p>
Return the last part of the TLS handshake payload of the standard TLS “ClientHello” message. This payload must be encapsulated in a TLS record.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> SE context </p></li>
<li><p><strong>data</strong> – <strong>[out]</strong> last ClientHello payload part</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TORSP_SUCCESS</strong> – on success </p></li>
<li><p><strong>TO_DEVICE_WRITE_ERROR</strong> – error writing data to Secure Element </p></li>
<li><p><strong>TO_DEVICE_READ_ERROR</strong> – error reading data from Secure Element </p></li>
<li><p><strong>TO_INVALID_RESPONSE_LENGTH</strong> – unexpected response length from device </p></li>
<li><p><strong>TO_MEMORY_ERROR</strong> – internal I/O buffer overflow </p></li>
<li><p><strong>TO_ERROR</strong> – generic error </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_hello_verify_request">
<span class="target" id="group__tlsoptim_1gabb462c4ab5525ee37237937bdeca9c7b"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_hello_verify_request</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">hello_verify_request</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">hello_verify_request_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_hello_verify_request" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the DTLS HelloVerifyRequest (server) message. </p>
<p>
When the client sends its ClientHello message to the server, the server MAY respond with a HelloVerifyRequest message. This message contains a stateless cookie. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This message processing is only needed in the case of DTLS</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>hello_verify_request</strong> – <strong>[in]</strong> HelloVerifyRequest message </p></li>
<li><p><strong>hello_verify_request_len</strong> – <strong>[in]</strong> HelloVerifyRequest message length </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_hello">
<span class="target" id="group__tlsoptim_1ga6e6beec2c1a0d1493efdf821e53ab1e4"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_hello</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">server_hello</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">server_hello_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_hello" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the ServerHello (server) message. </p>
<p>
The server will send this message in response to a ClientHello message when it was able to find an acceptable set of algorithms. If it cannot find such a match, it will respond with a handshake failure alert. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>server_hello</strong> – <strong>[in]</strong> ServertHello payload </p></li>
<li><p><strong>server_hello_len</strong> – <strong>[in]</strong> ServertHello payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_hello_init">
<span class="target" id="group__tlsoptim_1ga561dab512ffa180b239a7258ee96114a"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_hello_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">server_hello_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_hello_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handle TLS ServerHello - CAPI version - Init. </p>
<p>
Initialize handling of the TLS handshake payload of the standard TLS “ServerHello” message received during TLS handshake.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> SE context </p></li>
<li><p><strong>server_hello_len</strong> – <strong>[in]</strong> ServerHello payload length</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TORSP_SUCCESS</strong> – on success </p></li>
<li><p><strong>TO_DEVICE_WRITE_ERROR</strong> – error writing data to Secure Element </p></li>
<li><p><strong>TO_DEVICE_READ_ERROR</strong> – error reading data from Secure Element </p></li>
<li><p><strong>TORSP_ARG_OUT_OF_RANGE</strong> – bad content </p></li>
<li><p><strong>TO_MEMORY_ERROR</strong> – internal I/O buffer overflow </p></li>
<li><p><strong>TO_ERROR</strong> – generic error </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_hello_update">
<span class="target" id="group__tlsoptim_1ga59d42282ecaf7b97f0861eaa8d2a9f2d"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_hello_update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">part_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_hello_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handle TLS ServerHello - CAPI version - Update. </p>
<p>
Handle a part of the TLS handshake payload of the standard TLS “ServerHello” message received during TLS handshake.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> SE context </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> part of ServerHello payload </p></li>
<li><p><strong>part_len</strong> – <strong>[in]</strong> part length</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TORSP_SUCCESS</strong> – on success </p></li>
<li><p><strong>TO_DEVICE_WRITE_ERROR</strong> – error writing data to Secure Element </p></li>
<li><p><strong>TO_DEVICE_READ_ERROR</strong> – error reading data from Secure Element </p></li>
<li><p><strong>TORSP_ARG_OUT_OF_RANGE</strong> – bad content </p></li>
<li><p><strong>TO_MEMORY_ERROR</strong> – internal I/O buffer overflow </p></li>
<li><p><strong>TO_ERROR</strong> – generic error </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_hello_final">
<span class="target" id="group__tlsoptim_1ga23fe776e01834d19c5a22235818502b6"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_hello_final</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">last_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_hello_final" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handle TLS ServerHello - CAPI version - Final. </p>
<p>
Handle the last part of the TLS handshake payload of the standard TLS “ServerHello” message received during TLS handshake.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> SE context </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> last part of ServerHello payload </p></li>
<li><p><strong>last_len</strong> – <strong>[in]</strong> last part len</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TORSP_SUCCESS</strong> – on success </p></li>
<li><p><strong>TO_DEVICE_WRITE_ERROR</strong> – error writing data to Secure Element </p></li>
<li><p><strong>TO_DEVICE_READ_ERROR</strong> – error reading data from Secure Element </p></li>
<li><p><strong>TORSP_ARG_OUT_OF_RANGE</strong> – bad content </p></li>
<li><p><strong>TO_MEMORY_ERROR</strong> – internal I/O buffer overflow </p></li>
<li><p><strong>TO_ERROR</strong> – generic error </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_certificate">
<span class="target" id="group__tlsoptim_1ga101ab06eee28332b4b9c4fc0b91dce42"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_certificate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">server_certificate</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">server_certificate_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_certificate" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the TLS Certificate (server) message. </p>
<p>
The server MUST send a Certificate message whenever the agreed- upon key exchange method uses certificates for authentication (this includes all key exchange methods defined in this document except DH_anon). This message will always immediately follow the ServerHello message. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>server_certificate</strong> – <strong>[in]</strong> Certificate payload </p></li>
<li><p><strong>server_certificate_len</strong> – <strong>[in]</strong> Certificate payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_certificate_init">
<span class="target" id="group__tlsoptim_1gac8cdbb17174c884e950a91299732f4f8"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_certificate_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">server_certificate_init</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">server_certificate_init_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_certificate_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the TLS Server Certificate header (server) </p>
<p>
Handle TLS Server Certificate header from TLS handshake payload of the standard TLS “ServerCertificate” message. The goal of TOSE_tls_handle_server_certificate_ init(), udate() and final(), is to validate a certificate chain, and to store the public key of the first certificate. You must decapsulate it from TLS record prior to use this command. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>server_certificate_init</strong> – <strong>[in]</strong> Certificate payload header (handshake header<ul>
<li><p>certificates list length) </p></li>
</ul>
</p></li>
<li><p><strong>server_certificate_init_len</strong> – <strong>[in]</strong> Certificate payload header length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_certificate_update">
<span class="target" id="group__tlsoptim_1gad6b239c4c280d6d6c4d0d965b602856c"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_certificate_update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">server_certificate_update</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">server_certificate_update_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_certificate_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the TLS Server Certificate partial payload (server) </p>
<p>
Handle TLS Server Certificate partial payload from TLS handshake payload of the standard TLS “ServerCertificate” message, and if possible, verify the signature and memories the key of the current certificate of the certificates chain. You must decapsulate it from TLS record prior to use this command. This command can be called several times. <a class="reference internal" href="#group__tlsoptim_1gac8cdbb17174c884e950a91299732f4f8"><span class="std std-ref">TOSE_tls_handle_server_certificate_init()</span></a> must be called prior to this call. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>server_certificate_update</strong> – <strong>[in]</strong> Certificate partial payload </p></li>
<li><p><strong>server_certificate_update_len</strong> – <strong>[in]</strong> Certificate partial payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_certificate_final">
<span class="target" id="group__tlsoptim_1gae4d57f25080bc6ae2e2f686d6343d222"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_certificate_final</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_certificate_final" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Finishes the TLS Server Certificate handling (server) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context * Finish Server Certificate TLS handshake payload handling by verifying signature of last certificate and store the public key of the first certificate of the chain. You must decapsulate it from TLS record prior to use this command. Functions <a class="reference internal" href="#group__tlsoptim_1gac8cdbb17174c884e950a91299732f4f8"><span class="std std-ref">TOSE_tls_handle_server_certificate_init()</span></a>, and <a class="reference internal" href="#group__tlsoptim_1gad6b239c4c280d6d6c4d0d965b602856c"><span class="std std-ref">TOSE_tls_handle_server_certificate_update()</span></a> must be called prior to this call. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_key_exchange">
<span class="target" id="group__tlsoptim_1ga8f7800231e5751b68a3774c982e3ead3"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_key_exchange</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">server_key_exchange</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">server_key_exchange_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_key_exchange" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handle the TLS ServerKeyExchange (server) message. </p>
<p>
Handle TLS handshake payload of the standard TLS “ServerKeyExchange” message. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>server_key_exchange</strong> – <strong>[in]</strong> ServerKeyExchange payload </p></li>
<li><p><strong>server_key_exchange_len</strong> – <strong>[in]</strong> ServerKeyExchange payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_key_exchange_init">
<span class="target" id="group__tlsoptim_1ga47b9bca08e452a3feff58e87d5ae282f"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_key_exchange_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">server_key_exchange_init</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">server_key_exchange_init_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_key_exchange_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the TLS Server ServerKeyExchange (server) header. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>server_key_exchange_init</strong> – <strong>[in]</strong> ServerKeyExchange payload header (handshake header<ul>
<li><p>key_exchanges list length) </p></li>
</ul>
</p></li>
<li><p><strong>server_key_exchange_init_len</strong> – <strong>[in]</strong> ServerKeyExchange payload header length </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_key_exchange_update">
<span class="target" id="group__tlsoptim_1ga1244e09eac8c360768e90c78632c4138"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_key_exchange_update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">server_key_exchange_update</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">server_key_exchange_update_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_key_exchange_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the TLS Server ServerKeyExchange partial payload (server) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>server_key_exchange_update</strong> – <strong>[in]</strong> ServerKeyExchange partial payload </p></li>
<li><p><strong>server_key_exchange_update_len</strong> – <strong>[in]</strong> ServerKeyExchange partial payload length </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_key_exchange_final">
<span class="target" id="group__tlsoptim_1gaae33a835569db160595f487638b39d4b"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_key_exchange_final</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_key_exchange_final" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Finishes TLS Server ServerKeyExchange handling (server) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_certificate_request">
<span class="target" id="group__tlsoptim_1gaf241f2d349af7c9e3d6a8ebd59232e8d"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_certificate_request</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate_request</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">certificate_request_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_certificate_request" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the TLS CertificateRequest (server) message. </p>
<p>
The server MUST send a Certificate message whenever the agreed- upon key exchange method uses certificates for authentication (this includes all key exchange methods defined in this document except DH_anon). This message will always immediately follow the ServerHello message. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate_request</strong> – <strong>[in]</strong> CertificateRequest payload </p></li>
<li><p><strong>certificate_request_len</strong> – <strong>[in]</strong> CertificateRequest payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_server_hello_done">
<span class="target" id="group__tlsoptim_1ga479d72db5f155e424992dbf3ca95a2a3"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_server_hello_done</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">server_hello_done</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">server_hello_done_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_server_hello_done" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the DTLS ServerHelloDone (server) message. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>server_hello_done</strong> – <strong>[in]</strong> ServerHelloDone payload </p></li>
<li><p><strong>server_hello_done_len</strong> – <strong>[in]</strong> ServerHelloDone payload length </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_certificate">
<span class="target" id="group__tlsoptim_1gade7839b672da338d6234c1dc99d7ea6b"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_certificate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_certificate" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Generates the TLS Certificate (client) message. </p>
<p>
This is the first message the client can send after receiving a ServerHelloDone message. This message is only sent if the server requests a certificate. If no suitable certificate is available, the client MUST send a certificate message containing no certificates. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate</strong> – <strong>[out]</strong> Certificate payload </p></li>
<li><p><strong>certificate_len</strong> – <strong>[out]</strong> Certificate payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_certificate_init">
<span class="target" id="group__tlsoptim_1gae8728cab4fdc4b20e569479ce0297c38"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_certificate_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_certificate_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get the TLS Certificate initialization (client) </p>
<p>
This function is used with <a class="reference internal" href="#group__tlsoptim_1gae5ed90b04b1e02c36fff4197dcedb321"><span class="std std-ref">TOSE_tls_get_certificate_update()</span></a> and <a class="reference internal" href="#group__tlsoptim_1gaf4be265597410e2989c26b705be8d912"><span class="std std-ref">TOSE_tls_get_certificate_final()</span></a> to get TLS Certificate of more than 512 bytes without limitation. This first command initiates the process. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate</strong> – <strong>[out]</strong> Certificate payload </p></li>
<li><p><strong>certificate_len</strong> – <strong>[out]</strong> Certificate payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_certificate_update">
<span class="target" id="group__tlsoptim_1gae5ed90b04b1e02c36fff4197dcedb321"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_certificate_update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_certificate_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Gets the TLS Certificate update (client) </p>
<p>
This command can be called several times. Function <a class="reference internal" href="#group__tlsoptim_1gae8728cab4fdc4b20e569479ce0297c38"><span class="std std-ref">TOSE_tls_get_certificate_init()</span></a> must be called prior to this command. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate</strong> – <strong>[out]</strong> Certificate payload </p></li>
<li><p><strong>certificate_len</strong> – <strong>[out]</strong> Certificate payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_certificate_final">
<span class="target" id="group__tlsoptim_1gaf4be265597410e2989c26b705be8d912"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_certificate_final</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_certificate_final" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Gets the TLS Certificate finalize (client) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_client_key_exchange">
<span class="target" id="group__tlsoptim_1ga0a7e2e1cda9012afc4e9b752d135aa85"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_client_key_exchange</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">client_key_exchange</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">client_key_exchange_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_client_key_exchange" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Gets the TLS ClientKeyExchange (client) message. </p>
<p>
Get TLS handshake payload of the standard TLS message “ClientKeyExchange”, containing internal Secure Element’s ephemeral public key if using ECDHE cipher suite. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>client_key_exchange</strong> – <strong>[out]</strong> ClientKeyExchange payload </p></li>
<li><p><strong>client_key_exchange_len</strong> – <strong>[out]</strong> ClientKeyExchange payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_certificate_verify">
<span class="target" id="group__tlsoptim_1ga6979c0fa3e93e5151827f5439401e39f"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_certificate_verify</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate_verify</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">certificate_verify_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_certificate_verify" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Generates the TLS Certificate_Verify (client) message. </p>
<p>
This message is used to provide explicit verification of a client certificate. This message is only sent following a client certificate that has signing capability (i.e., all certificates except those containing fixed Diffie-Hellman parameters). When sent, it MUST immediately follow the client key exchange message. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>certificate_verify</strong> – <strong>[out]</strong> CertificateVerify payload </p></li>
<li><p><strong>certificate_verify_len</strong> – <strong>[out]</strong> CertificateVerify payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_change_cipher_spec">
<span class="target" id="group__tlsoptim_1ga9bf29ecd947d240d0f81162eb51ec8e3"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_change_cipher_spec</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">change_cipher_spec</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">change_cipher_spec_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_change_cipher_spec" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Generates the TLS Change_Cipher_Spec (client) message. </p>
<p>
The ChangeCipherSpec message is sent by both the client and the server to notify the receiving party that subsequent records will be protected under the newly negotiated CipherSpec and keys. This message is technically not part of the handshake. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>change_cipher_spec</strong> – <strong>[out]</strong> ChangeCipherSpec payload </p></li>
<li><p><strong>change_cipher_spec_len</strong> – <strong>[out]</strong> ChangeCipherSpec payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_finished">
<span class="target" id="group__tlsoptim_1gad2b989bcbae40707db86f55730177444"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_finished</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">finished</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">finished_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_finished" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Generates the TLS Finished (client) message. </p>
<p>
The Finished message is the first one protected with the just negotiated algorithms, keys, and secrets. Recipients of Finished messages MUST verify that the contents are correct. Once a side has sent its Finished message and received and validated the Finished message from its peer, it may begin to send and receive application data over the connection. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>finished</strong> – <strong>[out]</strong> Finish payload </p></li>
<li><p><strong>finished_len</strong> – <strong>[out]</strong> Finish payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_change_cipher_spec">
<span class="target" id="group__tlsoptim_1gaeeca277d71629c01a7922a3782ee4f4c"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_change_cipher_spec</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">change_cipher_spec</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">change_cipher_spec_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_change_cipher_spec" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the TLS ChangeCipherSpec (server) message. </p>
<p>
The change cipher spec protocol exists to signal transitions in ciphering strategies. The protocol consists of a single message, which is encrypted and compressed under the current (not the pending) connection state. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>change_cipher_spec</strong> – <strong>[in]</strong> ChangeCipherSpec payload </p></li>
<li><p><strong>change_cipher_spec_len</strong> – <strong>[in]</strong> ChangeCipherSpec payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_finished">
<span class="target" id="group__tlsoptim_1ga4a7c0b996bb253f6c3c71bbd03178ff3"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_finished</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">finished</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">finished_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_finished" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the TLS Finished (server) message. </p>
<p>
The Finished message is the first one protected with the just negotiated algorithms, keys, and secrets. Recipients of Finished messages MUST verify that the contents are correct. Once a side has sent its Finished message and received and validated the Finished message from its peer, it may begin to send and receive application data over the connection. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>finished</strong> – <strong>[in]</strong> Finished payload </p></li>
<li><p><strong>finished_len</strong> – <strong>[in]</strong> Finish payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_get_certificate_slot">
<span class="target" id="group__tlsoptim_1gac4847b3866c8300d0405d328ebc50bc9"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_get_certificate_slot</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">slot</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_get_certificate_slot" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Generates the TLS certificate slot used during handshake (client) message. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>slot</strong> – <strong>[out]</strong> Certificate slot </p></li>
</ul>
</dd>
<dt class="field-even">Post</dt>
<dd class="field-even"><p>Handshake must have been proceeded before calling this function. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_secure_payload">
<span class="target" id="group__tlsoptim_1ga6a997ad9f5faa0ac9f5e0fcf10ba2403"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_secure_payload</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">header</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">header_len</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">data_len</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">payload</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">payload_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_secure_payload" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Secures a (client) message with TLS. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>header</strong> – <strong>[in]</strong> TLS header </p></li>
<li><p><strong>header_len</strong> – <strong>[in]</strong> TLS header length </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> TLS data </p></li>
<li><p><strong>data_len</strong> – <strong>[in]</strong> TLS data length </p></li>
<li><p><strong>payload</strong> – <strong>[out]</strong> Secured message (without header) </p></li>
<li><p><strong>payload_len</strong> – <strong>[out]</strong> Secured message (without header) length </p></li>
</ul>
</dd>
<dt class="field-even">Post</dt>
<dd class="field-even"><p>Handshake must have been proceeded before calling this function. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_unsecure_payload">
<span class="target" id="group__tlsoptim_1gab41cb30ab490e5391ccffefd4476513f"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_unsecure_payload</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">header</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">header_len</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">payload</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n"><span class="pre">payload_len</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_unsecure_payload" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Unsecure message with TLS. </p>
<p>
Decrypt data received from server through TLS. Take a TLS record as input with encrypted content and return a TLS record with clear content. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>header</strong> – <strong>[in]</strong> TLS header </p></li>
<li><p><strong>header_len</strong> – <strong>[in]</strong> TLS header length </p></li>
<li><p><strong>payload</strong> – <strong>[in]</strong> Secured message (without header) </p></li>
<li><p><strong>payload_len</strong> – <strong>[in]</strong> Secured message (without header) length </p></li>
<li><p><strong>data</strong> – <strong>[out]</strong> TLS data </p></li>
<li><p><strong>data_len</strong> – <strong>[out]</strong> TLS data length </p></li>
</ul>
</dd>
<dt class="field-even">Post</dt>
<dd class="field-even"><p>Handshake must have been proceeded before calling this function.</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.TOSE_tls_handle_mediator_certificate">
<span class="target" id="group__tlsoptim_1gaa656f3d0aff4d6632f979a134369cffc"></span><a class="reference internal" href="defs.html#c.TO_ret_t" title="TO_ret_t"><span class="n"><span class="pre">TO_ret_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TOSE_tls_handle_mediator_certificate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="defs.html#c.TOSE_ctx_t" title="TOSE_ctx_t"><span class="n"><span class="pre">TOSE_ctx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mediator_certificate</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">mediator_certificate_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.TOSE_tls_handle_mediator_certificate" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the TLS proprietary MediatorCertificate (server) message. </p>
<p>
This is a TO-specific message, used to handle the mediator certificate. This message is not part of any standard (TLS or DTLS). </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> Pointer to the SE context </p></li>
<li><p><strong>mediator_certificate</strong> – <strong>[in]</strong> MediatorCertificate payload </p></li>
<li><p><strong>mediator_certificate_len</strong> – <strong>[in]</strong> MediatorCertificate payload length</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2017, Trusted Objects.
      
    </div>

    

    
  </body>
</html>